<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storopack - Assistente T√©cnico</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#f5f7fa 0%,#e8edf2 100%);color:#333;min-height:100vh}

        /* HEADER - RESPONSIVO */
        .header{background:#fff;padding:16px 20px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 12px rgba(0,0,0,.08);position:sticky;top:0;z-index:100;border-bottom:3px solid #0056a3}
        .header img{height:120px;object-fit:contain;max-width:80%}
        .hdr-btn-reset{position:fixed;top:12px;right:12px;z-index:110;background:#f0f4f8;border:none;color:#0056a3;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:.9em;font-weight:500}
        .hdr-btn-reset:hover{background:#e1e8f0}

        .container{max-width:960px;margin:0 auto;padding:16px 16px 80px}

        /* WELCOME */
        .welcome{text-align:center;padding:24px 16px 16px;background:#fff;border-radius:16px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,.05)}
        .welcome h2{font-size:1.4em;color:#0056a3;margin-bottom:6px;font-weight:600}
        .welcome p{color:#666;font-size:.92em}

        .categories{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin-top:16px}
        .cat-card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.08);cursor:pointer;transition:all .3s ease;border:2px solid transparent;position:relative}
        .cat-card:hover{transform:translateY(-4px);box-shadow:0 8px 24px rgba(0,86,163,.15);border-color:#0056a3}
        .cat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,#0056a3,#0078d4);opacity:0;transition:opacity .3s}
        .cat-card:hover::before{opacity:1}
        .cat-card img{width:100%;height:150px;object-fit:contain;background:#f8fafc;padding:8px}
        .cat-card-body{padding:12px;text-align:center}
        .cat-card-body h3{font-size:1em;color:#0056a3;margin-bottom:2px;font-weight:600}
        .cat-card-body p{font-size:.78em;color:#999}

        /* SUBCATEGORIAS */
        .subcats{display:none;animation:fadeIn .3s}
        .subcats.active{display:block}
        .sub-hdr{margin-bottom:16px;padding:14px 16px;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.05);display:flex;align-items:center;justify-content:space-between}
        .sub-hdr h3{font-size:1.15em;color:#0056a3;font-weight:600}
        .btn-voltar{background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff;border:none;padding:10px 20px;border-radius:10px;cursor:pointer;font-size:.9em;font-weight:600;transition:all .2s;display:flex;align-items:center;gap:6px}
        .btn-voltar:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,86,163,.3)}
        .equip-display{background:#fff;border-radius:14px;padding:20px;text-align:center;box-shadow:0 3px 10px rgba(0,0,0,.06);margin-bottom:16px}
        .equip-display img{max-height:160px;object-fit:contain;margin-bottom:8px}
        .equip-display h4{font-size:1em;color:#333;font-weight:600}
        .equip-display p{font-size:.78em;color:#aaa}
        .prod-section{margin-top:4px}
        .prod-section h4{font-size:.95em;color:#0056a3;margin-bottom:10px;font-weight:600;padding-left:4px}
        .prod-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}
        .prod-item{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.06);cursor:pointer;transition:all .3s;border:2px solid transparent;text-align:center}
        .prod-item:hover{border-color:#0056a3;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,86,163,.12)}
        .prod-item img{width:100%;height:85px;object-fit:cover;background:#f8fafc}
        .prod-item span{display:block;padding:10px 4px;font-size:.85em;font-weight:600;color:#333}
        .sub-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:14px;margin-bottom:16px}
        .sub-card{background:#fff;border-radius:14px;padding:18px 14px;text-align:center;box-shadow:0 3px 10px rgba(0,0,0,.06);cursor:pointer;transition:all .3s;border:2px solid transparent}
        .sub-card:hover{transform:translateY(-3px);border-color:#0056a3;box-shadow:0 6px 16px rgba(0,86,163,.12)}
        .sub-card img{width:100%;height:90px;object-fit:contain;margin-bottom:10px;border-radius:8px}
        .sub-card h4{font-size:.95em;color:#333;font-weight:600;margin-bottom:4px}
        .sub-card p{font-size:.75em;color:#aaa}

        /* ============ CHAT BONITO ============ */
        .chat-box{display:none;flex-direction:column;background:#fff;border-radius:16px;border:2px solid #e0e7ef;box-shadow:0 4px 20px rgba(0,0,0,.1);overflow:hidden;height:calc(100vh - 200px);max-height:700px}
        .chat-box.active{display:flex}
        .chat-hdr{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(135deg,#0056a3,#0078d4);padding:14px 18px;color:#fff;border-bottom:2px solid #004a8f}
        .chat-hdr h3{font-size:1em;font-weight:600}
        .chat-hdr .btn-voltar-chat{background:rgba(255,255,255,.2);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:.85em;font-weight:600;transition:background .2s}
        .chat-hdr .btn-voltar-chat:hover{background:rgba(255,255,255,.35)}
        .chat-msgs{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px;background:#f0f4f8}
        .msg{max-width:80%;padding:12px 16px;border-radius:18px;font-size:.92em;line-height:1.6;word-wrap:break-word;white-space:pre-wrap;animation:slideIn .3s}
        .msg.bot{align-self:flex-start;background:#fff;border:1px solid #dde3ea;border-bottom-left-radius:4px;color:#333;box-shadow:0 1px 4px rgba(0,0,0,.06)}
        .msg.user{align-self:flex-end;background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff;border-bottom-right-radius:4px;box-shadow:0 2px 8px rgba(0,86,163,.2)}
        .msg .tm{font-size:.7em;opacity:.5;margin-top:6px;display:block}
        .typing{display:none;align-self:flex-start;padding:10px 16px;background:#fff;border-radius:18px;border:1px solid #dde3ea;color:#999;font-size:.85em;box-shadow:0 1px 4px rgba(0,0,0,.06)}
        .typing.active{display:block}
        .typing::after{content:'...';animation:dots 1.5s infinite}
        .chat-input{display:flex;gap:8px;padding:12px 14px;border-top:2px solid #e0e7ef;background:#fff;align-items:flex-end}
        .chat-input textarea{flex:1;padding:10px 14px;border:2px solid #e0e7ef;border-radius:12px;font-size:.93em;resize:none;min-height:42px;max-height:100px;font-family:inherit;outline:none;transition:border-color .2s}
        .chat-input textarea:focus{border-color:#0056a3;box-shadow:0 0 0 3px rgba(0,86,163,.1)}
        .chat-input button{border:none;border-radius:12px;padding:10px 16px;cursor:pointer;font-size:.9em;min-height:42px;transition:all .2s;font-weight:600}
        .btn-send{background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff;box-shadow:0 2px 6px rgba(0,86,163,.2)}
        .btn-send:hover{box-shadow:0 4px 12px rgba(0,86,163,.3)}
        .btn-send:disabled{background:#a0bdd9;cursor:not-allowed;box-shadow:none}
        .btn-att{background:#f0f4f8;color:#0056a3;border:2px solid #e0e7ef}
        .btn-att:hover{background:#e1e8f0}

        /* FEEDBACK MODAL */
        .fb-bar{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:250;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
        .fb-bar.active{display:flex}
        .fb-bar .fb-inner{background:#fff;border-radius:20px;padding:36px 28px;max-width:420px;width:90%;text-align:center;box-shadow:0 12px 48px rgba(0,0,0,.3);animation:modalSlide .3s}
        .fb-bar p{font-size:1.15em;color:#333;margin-bottom:20px;font-weight:600}
        .fb-bar .btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
        .fb-bar .b{padding:14px 28px;border-radius:12px;border:none;cursor:pointer;font-size:1em;font-weight:600;color:#fff;transition:transform .2s}
        .fb-bar .b:hover{transform:scale(1.05)}
        .b-ok{background:#28a745}
        .b-no{background:#dc3545}

        /* PE√áAS INFO */
        .pecas-info{background:#fff;border-radius:16px;padding:32px;text-align:center;box-shadow:0 4px 16px rgba(0,0,0,.08);margin-top:20px;display:none}
        .pecas-info img{width:100%;max-width:400px;height:250px;object-fit:cover;border-radius:12px;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,.1)}
        .pecas-info h3{color:#0056a3;margin:12px 0;font-size:1.3em;font-weight:600}
        .pecas-info p{color:#666;line-height:1.7;font-size:.95em}
        .pecas-info a{color:#0056a3;text-decoration:none}

        /* MODAIS */
        .registro-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:300;align-items:center;justify-content:center;backdrop-filter:blur(6px)}
        .registro-modal.active{display:flex}
        .registro-content{background:#fff;border-radius:16px;padding:32px;max-width:440px;width:90%;box-shadow:0 12px 48px rgba(0,0,0,.3)}
        .registro-content h3{color:#0056a3;margin-bottom:8px;font-size:1.4em;font-weight:600;text-align:center}
        .registro-content p{color:#666;font-size:.9em;margin-bottom:20px;text-align:center}
        .registro-content label{display:block;color:#333;font-size:.9em;font-weight:500;margin-bottom:6px;margin-top:14px}
        .registro-content input{width:100%;padding:12px 14px;border:2px solid #e8edf2;border-radius:10px;font-size:.95em;outline:none}
        .registro-content input:focus{border-color:#0056a3}
        .registro-content .hint{font-size:.8em;color:#999;margin-top:4px}
        .registro-content button{background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff;border:none;padding:12px 24px;border-radius:10px;cursor:pointer;font-size:1em;font-weight:600;width:100%;margin-top:20px}
        .registro-content .erro{color:#dc3545;font-size:.85em;margin-top:8px;display:none}
        .overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:200;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
        .overlay.active{display:flex}
        .modal{background:#fff;border-radius:16px;padding:32px;max-width:420px;width:90%;text-align:center;box-shadow:0 12px 48px rgba(0,0,0,.3);animation:modalSlide .3s}
        .modal h3{color:#0056a3;margin-bottom:12px;font-size:1.3em;font-weight:600}
        .modal p{color:#666;font-size:.92em;margin-bottom:18px;line-height:1.6}
        .modal .mg{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
        .modal .btn{padding:10px 24px;border-radius:10px;border:none;cursor:pointer;font-size:.95em;font-weight:600}
        .modal .bp{background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff}
        .modal .bs{background:#f0f4f8;color:#0056a3}
        @keyframes modalSlide{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
        .video-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.95);z-index:300;align-items:center;justify-content:center;padding:20px}
        .video-modal.active{display:flex}
        .video-container{background:#000;border-radius:16px;overflow:hidden;max-width:900px;width:100%;max-height:90vh}
        .video-header{background:linear-gradient(135deg,#0056a3,#0078d4);color:#fff;padding:14px 22px;display:flex;justify-content:space-between;align-items:center}
        .video-header h3{font-size:1.15em;margin:0;font-weight:600}
        .video-close{background:rgba(255,255,255,.2);border:none;color:#fff;width:36px;height:36px;border-radius:8px;cursor:pointer;font-size:1.4em}
        .video-wrapper{position:relative;width:100%;padding-top:56.25%;background:#000}
        .video-wrapper video{position:absolute;top:0;left:0;width:100%;height:100%}
        .video-error{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;text-align:center;display:none}
        .toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:12px 24px;border-radius:12px;font-size:.9em;z-index:300;display:none;box-shadow:0 4px 16px rgba(0,0,0,.3);font-weight:500}
        .toast.active{display:block;animation:slideUp .3s}
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}
        @keyframes slideIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes slideUp{from{opacity:0;transform:translate(-50%,10px)}to{opacity:1;transform:translate(-50%,0)}}
        @keyframes dots{0%,20%{content:''}40%{content:'.'}60%{content:'..'}80%,100%{content:'...'}}

        /* ============ MOBILE ============ */
        @media(max-width:600px){
            body{font-size:14px}
            .container{padding:10px 10px 90px}
            .header{padding:10px 14px}
            .header img{height:60px}
            .welcome{padding:14px 12px;margin-bottom:12px}.welcome h2{font-size:1.15em}
            .categories{grid-template-columns:repeat(2,1fr);gap:10px}
            .cat-card img{height:110px;padding:6px}
            .cat-card-body{padding:10px 8px}.cat-card-body h3{font-size:.88em}.cat-card-body p{font-size:.72em}
            .sub-hdr{padding:10px 12px;flex-wrap:wrap;gap:8px}.sub-hdr h3{font-size:.95em}
            .btn-voltar{padding:8px 14px;font-size:.82em}
            .equip-display{padding:14px}.equip-display img{max-height:100px}
            .sub-grid{grid-template-columns:repeat(2,1fr);gap:10px}
            .sub-card{padding:12px 8px}.sub-card img{height:70px}.sub-card h4{font-size:.84em}
            .prod-row{grid-template-columns:repeat(2,1fr);gap:8px}
            .prod-item img{height:65px}.prod-item span{font-size:.78em;padding:8px 3px}
            /* CHAT FULLSCREEN NO MOBILE */
            .chat-box{position:fixed;top:0;left:0;right:0;bottom:0;z-index:200;height:100vh;max-height:100vh;border-radius:0;border:none;box-shadow:none}
            .chat-hdr{border-radius:0;padding:12px 14px}
            .chat-hdr h3{font-size:.9em}
            .chat-msgs{padding:12px 10px;gap:8px}
            .msg{max-width:85%;padding:10px 14px;font-size:.9em;border-radius:16px}
            .chat-input{padding:10px;gap:6px;border-radius:0}
            .chat-input textarea{font-size:16px!important;min-height:40px;padding:10px 12px;border-radius:10px}
            .chat-input button{padding:10px 14px;min-height:40px;border-radius:10px;font-size:.88em}
            .pecas-info{padding:20px 14px;margin-top:14px}.pecas-info img{height:170px}
            .registro-content{padding:22px 16px;width:92%}
            .registro-content input{font-size:16px!important}
            .modal{padding:24px 18px;width:92%}
            .toast{bottom:70px}
            .cat-card:hover{transform:none}
            .sub-card:hover{transform:none}
            input[type="text"],input[type="tel"],textarea{font-size:16px!important}
        }
        @media(max-width:360px){
            body{font-size:13px}
            .header img{height:50px}
            .cat-card img{height:95px}
            .msg{max-width:88%;font-size:.87em}
        }
        /* TABLET */
        @media(min-width:601px) and (max-width:900px){
            .header img{height:90px}
            .categories{grid-template-columns:repeat(2,1fr)}
            .prod-row{grid-template-columns:repeat(4,1fr)}
            .chat-box{height:calc(100vh - 180px);max-height:650px}
        }
        /* DESKTOP */
        @media(min-width:901px){
            .header img{height:120px}
            .categories{grid-template-columns:repeat(4,1fr)}
            .prod-row{grid-template-columns:repeat(4,1fr)}
            .chat-box{height:calc(100vh - 200px);max-height:700px}
        }
        @supports(padding:max(0px)){@media(max-width:600px){
            .chat-input{padding-bottom:max(10px,env(safe-area-inset-bottom))}
        }}
    </style>
</head>
<body>

<div class="header">
    <img src="/static/logo/logo1.jpg" alt="Storopack - Perfect Protective Packaging">
</div>
<button class="hdr-btn-reset" onclick="reiniciarSistema()" title="Reiniciar">&#8635;</button>

<!-- REGISTRO -->
<div id="registroModal" class="registro-modal">
    <div class="registro-content">
        <h3>üìã Registro de Contato</h3>
        <p>Para melhor atend√™-lo, precisamos de algumas informa√ß√µes.</p>
        <label for="nomeCliente">Nome completo</label>
        <input type="text" id="nomeCliente" placeholder="Digite seu nome">
        <label for="telefoneCliente">Telefone com DDD</label>
        <input type="tel" id="telefoneCliente" placeholder="(11) 99999-9999">
        <div class="hint" id="telHint"></div>
        <button onclick="salvarRegistro()">Continuar</button>
        <p class="erro" id="registroErro">Por favor, preencha todos os campos</p>
    </div>
</div>

<div class="container">
    <!-- MENU PRINCIPAL -->
    <div id="telaMenu">
        <div class="welcome">
            <h2>üëã Ol√°! Em que posso ajudar?</h2>
            <p>Selecione a linha de equipamento para suporte t√©cnico especializado</p>
        </div>
        <div class="categories">
                <div class="cat-card" onclick="abrirCat('airplus')">
                    <img src="https://www.bonustrading.co.uk/pub/media/catalog/product/cache/dc51ad1cee65ef039961365aac012b96/a/i/airplus-mini-machine-blue-film-600_1.jpg" alt="AIRplus">
                    <div class="cat-card-body"><h3>AIRplus</h3><p>Travesseiros de ar</p></div>
                </div>
                <div class="cat-card" onclick="abrirCat('airmove')">
                    <img src="https://www.storopack.com.br/fileadmin/_processed_/7/e/csm_PP_AP_AIRmove___machine_front_motive2_cushion_film_low_res_300dpi_061fd19c2b.jpg" alt="AIRmoves">
                    <div class="cat-card-body"><h3>AIRmoves</h3><p>Linha compacta de ar</p></div>
                </div>
                <div class="cat-card" onclick="abrirCat('foamplus')">
                    <img src="https://img.directindustry.com/pt/images_di/photo-g/34409-12098488.jpg" alt="FOAMplus">
                    <div class="cat-card-body"><h3>FOAMplus</h3><p>Espuma Expansiva</p></div>
                </div>
                <div class="cat-card" onclick="abrirCat('paperplus')">
                    <img src="https://www.storopack.com.br/fileadmin/_processed_/5/9/csm_PP_PP_Shooter_machine_tablestand_motive_1_1280x580px_c97e386ad4.png" alt="PAPERplus">
                    <div class="cat-card-body"><h3>PAPERplus</h3><p>Papel amassado</p></div>
                </div>
        </div>
        <!-- PE√áAS -->
        <div class="pecas-info" id="pecasInfo">
            <img src="https://www.storopack.com/fileadmin/_processed_/f/3/csm_PI_Packaging_Technical_Service_6584_640x590px_a4449a471c.jpg" alt="T√©cnico Storopack">
            <h3>üìû Precisa de pe√ßas?</h3>
            <p>Entre em contato com nossa equipe t√©cnica para solicitar pe√ßas de reposi√ß√£o originais Storopack.</p>
            <p style="margin-top:12px;color:#0056a3;font-weight:600">
                ‚òéÔ∏è (11) 5677-4699<br>
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="#25D366" style="vertical-align:middle;margin-right:3px"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.625.846 5.059 2.284 7.034L.789 23.492a.5.5 0 00.612.638l4.716-1.234A11.947 11.947 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-2.37 0-4.567-.82-6.29-2.19l-.438-.362-3.21.84.855-3.122-.396-.463A9.96 9.96 0 012 12C2 6.486 6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"/></svg>
                (11) 98765-4321<br>
                ‚úâÔ∏è <a href="mailto:packaging.br@storopack.com">packaging.br@storopack.com</a>
            </p>
        </div>
    </div>

    <!-- SUB: AIRplus -->
    <div id="sub_airplus" class="subcats">
        <div class="sub-hdr">
            <h3>üåÄ AIRplus - Selecione o modelo</h3>
            <button class="btn-voltar" onclick="voltar()">&#8592; Voltar</button>
        </div>
        <div class="equip-display">
            <img src="https://www.bonustrading.co.uk/pub/media/catalog/product/cache/dc51ad1cee65ef039961365aac012b96/a/i/airplus-mini-machine-blue-film-600_1.jpg" alt="AIRplus Mini">
            <h4>AIRplus Mini</h4>
            <p>Compacto</p>
        </div>
        <div class="prod-section">
            <h4>üì¶ Qual modelo est√° utilizando?</h4>
            <div class="prod-row">
                <div class="prod-item" onclick="abrirChat('airplus_void','AIRplus Void')"><img src="https://www.storopack.com.br/fileadmin/_processed_/0/9/csm_AIRplus_Repositioning_dcf3a635a8.jpg" alt="Void"><span>Void</span></div>
                <div class="prod-item" onclick="abrirChat('airplus_cushion','AIRplus Cushion')"><img src="https://networkpack.co.uk/wp-content/uploads/2018/04/Storopack-AirPlus-Cushion.jpg" alt="Cushion"><span>Cushion</span></div>
                <div class="prod-item" onclick="abrirChat('airplus_bubble','AIRplus Bubble')"><img src="https://img.directindustry.com/images_di/photo-g/34409-12098185.webp" alt="Bubble"><span>Bubble</span></div>
                <div class="prod-item" onclick="abrirChat('airplus_wrap','AIRplus Wrap 140d')"><img src="https://img.directindustry.com/images_di/photo-g/34409-12098203.jpg" alt="Wrap"><span>Wrap 140d</span></div>
            </div>
        </div>
    </div>

    <!-- SUB: AIRmoves -->
    <div id="sub_airmove" class="subcats">
        <div class="sub-hdr">
            <h3>üåÄ AIRmoves - Selecione o modelo</h3>
            <button class="btn-voltar" onclick="voltar()">&#8592; Voltar</button>
        </div>
        <div class="sub-grid">
            <div class="sub-card" onclick="abrirSubAirmove('airmove1')">
                <img src="https://www.storopack.com.br/fileadmin/_processed_/8/b/csm_PP_AP_AIRmove_machine_side_motive4_with_void_film_1280x580px_569007f63e.jpg" alt="AIRmove 1">
                <h4>AIRmove 1</h4>
            </div>
            <div class="sub-card" onclick="abrirSubAirmove('airmove2')">
                <img src="https://www.storopack.com.br/fileadmin/_processed_/7/e/csm_PP_AP_AIRmove___machine_front_motive2_cushion_film_low_res_300dpi_061fd19c2b.jpg" alt="AIRmove 2">
                <h4>AIRmove 2</h4>
            </div>
        </div>
    </div>

    <!-- SUB-SUB: AIRmove 1 materiais -->
    <div id="sub_airmove1" class="subcats">
        <div class="sub-hdr">
            <h3>üåÄ AIRmove 1 - Qual modelo est√° utilizando?</h3>
            <button class="btn-voltar" onclick="voltarAirmove()">&#8592; Voltar</button>
        </div>
        <div class="equip-display">
            <img src="https://www.storopack.com.br/fileadmin/_processed_/8/b/csm_PP_AP_AIRmove_machine_side_motive4_with_void_film_1280x580px_569007f63e.jpg" alt="AIRmove 1">
            <h4>AIRmove 1</h4>
        </div>
        <div class="prod-section">
            <div class="prod-row">
                <div class="prod-item" onclick="abrirChat('airmove1_void','AIRmove 1 Void')"><img src="https://www.storopack.com.br/fileadmin/_processed_/0/9/csm_AIRplus_Repositioning_dcf3a635a8.jpg" alt="Void"><span>Void</span></div>
                <div class="prod-item" onclick="abrirChat('airmove1_cushion','AIRmove 1 Cushion')"><img src="https://networkpack.co.uk/wp-content/uploads/2018/04/Storopack-AirPlus-Cushion.jpg" alt="Cushion"><span>Cushion</span></div>
            </div>
        </div>
    </div>

    <!-- SUB-SUB: AIRmove 2 materiais -->
    <div id="sub_airmove2" class="subcats">
        <div class="sub-hdr">
            <h3>üåÄ AIRmove 2 - Qual modelo est√° utilizando?</h3>
            <button class="btn-voltar" onclick="voltarAirmove()">&#8592; Voltar</button>
        </div>
        <div class="equip-display">
            <img src="https://www.storopack.com.br/fileadmin/_processed_/7/e/csm_PP_AP_AIRmove___machine_front_motive2_cushion_film_low_res_300dpi_061fd19c2b.jpg" alt="AIRmove 2">
            <h4>AIRmove 2</h4>
        </div>
        <div class="prod-section">
            <div class="prod-row">
                <div class="prod-item" onclick="abrirChat('airmove2_void','AIRmove 2 Void')"><img src="https://www.storopack.com.br/fileadmin/_processed_/0/9/csm_AIRplus_Repositioning_dcf3a635a8.jpg" alt="Void"><span>Void</span></div>
                <div class="prod-item" onclick="abrirChat('airmove2_cushion','AIRmove 2 Cushion')"><img src="https://networkpack.co.uk/wp-content/uploads/2018/04/Storopack-AirPlus-Cushion.jpg" alt="Cushion"><span>Cushion</span></div>
                <div class="prod-item" onclick="abrirChat('airmove2_bubble','AIRmove 2 Bubble')"><img src="https://img.directindustry.com/images_di/photo-g/34409-12098185.webp" alt="Bubble"><span>Bubble</span></div>
                <div class="prod-item" onclick="abrirChat('airmove2_wrap','AIRmove 2 Wrap 140d')"><img src="https://img.directindustry.com/images_di/photo-g/34409-12098203.jpg" alt="Wrap"><span>Wrap 140d</span></div>
            </div>
        </div>
    </div>

    <!-- SUB: FOAMplus -->
    <div id="sub_foamplus" class="subcats">
        <div class="sub-hdr">
            <h3>üí® FOAMplus - Selecione o modelo</h3>
            <button class="btn-voltar" onclick="voltar()">&#8592; Voltar</button>
        </div>
        <div class="sub-grid">
            <div class="sub-card" onclick="abrirChat('foam_bagpacker','FOAMplus Bag Packer')">
                <img src="https://img.directindustry.com/pt/images_di/photo-g/34409-12098488.jpg" alt="Bag Packer">
                <h4>Bag Packer</h4><p>Sacos de espuma</p>
            </div>
            <div class="sub-card" onclick="abrirChat('foam_handpacker','FOAMplus Hand Packer')">
                <img src="https://5.imimg.com/data5/HS/KC/MW/SELLER-8794370/foamplus-hand-packer-2-machine.jpg" alt="Hand Packer">
                <h4>Hand Packer</h4><p>Manual</p>
            </div>
        </div>
    </div>

    <!-- SUB: PAPERplus -->
    <div id="sub_paperplus" class="subcats">
        <div class="sub-hdr">
            <h3>üìÑ PAPERplus - Selecione o modelo</h3>
            <button class="btn-voltar" onclick="voltar()">&#8592; Voltar</button>
        </div>
        <div class="sub-grid">
            <div class="sub-card" onclick="abrirChat('paper_shooter','PAPERplus Shooter')"><img src="https://www.storopack.com.br/fileadmin/_processed_/5/9/csm_PP_PP_Shooter_machine_tablestand_motive_1_1280x580px_c97e386ad4.png" alt="Shooter"><h4>Shooter</h4><p>Mesa</p></div>
            <div class="sub-card" onclick="abrirChat('paper_papillon','PAPERplus Papillon')"><img src="https://files.lbcdn.info/i/o/aHR0cHM6Ly93d3cuZ3JlZW5vc3VwcGx5LmNvbS9JbWFnZXMvR3JlZW5vdWdoJTIwUGljcy9QQVBFUnBsdXMlQzIlQUUlMjBQYXBpbGxvbiUyMFBhcGVyJTIwUGFja2FnaW5nJTIwU3lzdGVtLmpwZw2.jpg" alt="Papillon"><h4>Papillon</h4><p>Sistema</p></div>
            <div class="sub-card" onclick="abrirChat('paper_classic','PAPERplus Classic')"><img src="https://packair.ru/files/PACKAIR/photo/STOROPACK/PAPERplus/paperplus_classic.jpg" alt="Classic"><h4>Classic</h4><p>Cl√°ssico</p></div>
            <div class="sub-card" onclick="abrirChat('paper_cx','PAPERplus CX')"><img src="https://www.storopack.com.br/fileadmin/_processed_/1/e/csm_PP_PP_Classic_CX_machine_0539_1280x580px_EUROPEAN_STAND_756b4e2466.png" alt="CX"><h4>CX</h4><p>Vers√£o CX</p></div>
            <div class="sub-card" onclick="abrirChat('paper_track','PAPERplus Track')"><img src="https://bvs-verpacken.com/wp-content/uploads/2025/01/papierpolster-system-track-03.png" alt="Track"><h4>Track</h4><p>Sistema Track</p></div>
            <div class="sub-card" onclick="abrirChat('paper_chevron','PAPERplus Chevron')"><img src="https://www.storopack.com.br/fileadmin/_processed_/b/c/csm_PP_PP_Chevron___machine_floorstand_with_conveyor_motive2_1280x580px_900e25faea.png" alt="Chevron"><h4>Chevron</h4><p>Com esteira</p></div>
        </div>
    </div>

    <!-- CHAT -->
    <div id="telaChat" class="chat-box">
        <div class="chat-hdr">
            <button class="btn-voltar-chat" onclick="voltar()">&#8592; Voltar</button>
            <h3 id="chatInfo"></h3>
        </div>
        <div id="chatMsgs" class="chat-msgs"></div>
        <div id="typing" class="typing">T√©cnico digitando</div>
        <div class="chat-input">
            <textarea id="chatIn" placeholder="Digite sua d√∫vida ou problema..." rows="1" onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();enviar()}" oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea>
            <input type="file" id="videoInput" accept="video/*" style="display:none" onchange="enviarVideo(this)">
            <button class="btn-att" onclick="document.getElementById('videoInput').click()">üìπ</button>
            <button id="btnSend" class="btn-send" onclick="enviar()">Enviar</button>
        </div>
        <div id="fbBar" class="fb-bar">
            <div class="fb-inner">
                <p>‚úÖ Conseguimos resolver seu problema?</p>
                <div class="btns">
                    <button class="b b-ok" onclick="enviarFb(true)">Sim, resolvido!</button>
                    <button class="b b-no" onclick="enviarFb(false)">N√£o, preciso de ajuda</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- GPS -->
<div id="gpsOverlay" class="overlay active">
    <div class="modal">
        <h3>üìç Permitir localiza√ß√£o</h3>
        <p>Para enviar um t√©cnico se necess√°rio, precisamos da sua localiza√ß√£o.</p>
        <div id="gpsLoading" style="display:none;text-align:center;padding:12px 0;color:#0056a3;font-weight:600">‚è≥ Obtendo localiza√ß√£o...</div>
        <div id="gpsBtns" class="mg">
            <button class="btn bp" onclick="permitirGPS()">‚úÖ Permitir</button>
            <button class="btn bs" onclick="negarGPS()">Continuar sem GPS</button>
        </div>
    </div>
</div>

<!-- VIDEO -->
<div id="videoModal" class="video-modal">
    <div class="video-container">
        <div class="video-header"><h3 id="videoTitle">Solu√ß√£o</h3><button class="video-close" onclick="fecharVideo()">√ó</button></div>
        <div class="video-wrapper">
            <video id="videoPlayer" controls><source id="videoSource" src="" type="video/mp4"></video>
            <div id="videoError" class="video-error"><p>‚ö†Ô∏è Erro ao carregar v√≠deo</p></div>
        </div>
    </div>
</div>

<div id="toast" class="toast"></div>

<script>
var sid='sess_'+Math.random().toString(36).substr(2,9),modAtual='',nomeAtual='',chamadoId=null,tela='menu';
var lat=null,lng=null,clienteNome='',clienteTelefone='',registroCompleto=false;
var videosErros={'E1':{titulo:'E1 - Sensor Temp',arquivo:'/static/erros/e1.mp4'},'E2':{titulo:'E2 - Resist√™ncia',arquivo:'/static/erros/e2.mp4'},'E3':{titulo:'E3 - Sensor Filme',arquivo:'/static/erros/e3.mp4'},'E4':{titulo:'E4 - Posicionamento',arquivo:'/static/erros/e4.mp4'},'E5':{titulo:'E5 - Motor',arquivo:'/static/erros/e5.mp4'},'E6':{titulo:'E6 - Termopar',arquivo:'/static/erros/e6.mp4'},'E7':{titulo:'E7 - Termopar',arquivo:'/static/erros/e7.mp4'},'E8':{titulo:'E8 - Termopar',arquivo:'/static/erros/e8.mp4'},'E9':{titulo:'E9 - Calibra√ß√£o',arquivo:'/static/erros/e9.mp4'},'E10':{titulo:'E10 - Par√¢metro',arquivo:'/static/erros/e10.mp4'},'E11':{titulo:'E11 - Instabilidade',arquivo:'/static/erros/e11.mp4'}};

function detectarTelefone(){var t=localStorage.getItem('telefone_cliente');if(t){document.getElementById('telefoneCliente').value=t;document.getElementById('telHint').innerHTML='‚úÖ N√∫mero detectado.';document.getElementById('telHint').style.color='#28a745'}}
function mostrarRegistro(){document.getElementById('registroModal').classList.add('active');detectarTelefone();document.getElementById('nomeCliente').focus()}
function salvarRegistro(){var n=document.getElementById('nomeCliente').value.trim(),t=document.getElementById('telefoneCliente').value.trim();if(!n||!t){document.getElementById('registroErro').style.display='block';return}var tl=t.replace(/\D/g,'');if(tl.length<10){document.getElementById('registroErro').textContent='Telefone inv√°lido';document.getElementById('registroErro').style.display='block';return}clienteNome=n;clienteTelefone=t;registroCompleto=true;localStorage.setItem('nome_cliente',n);localStorage.setItem('telefone_cliente',t);fetch('/registrar-contato',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({nome:n,telefone:t,session_id:sid})});document.getElementById('registroModal').classList.remove('active');showToast('‚úÖ Bem-vindo, '+n.split(' ')[0]+'!')}
document.getElementById('telefoneCliente').addEventListener('input',function(e){var v=e.target.value.replace(/\D/g,'');if(v.length<=11){v=v.replace(/^(\d{2})(\d)/g,'($1) $2');v=v.replace(/(\d)(\d{4})$/,'$1-$2');e.target.value=v}});

// GPS IMEDIATO
// GPS IMEDIATO - sempre pedir se n√£o tem coordenadas salvas
(function(){
    var latSalvo=localStorage.getItem('gps_lat');
    var lngSalvo=localStorage.getItem('gps_lng');
    if(latSalvo&&lngSalvo){
        lat=parseFloat(latSalvo);lng=parseFloat(lngSalvo);
        document.getElementById('gpsOverlay').classList.remove('active');
        // Atualizar silenciosamente
        if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(p){
            lat=p.coords.latitude;lng=p.coords.longitude;
            localStorage.setItem('gps_lat',lat);localStorage.setItem('gps_lng',lng);
            enviarLocalizacao();
        },function(){},{timeout:5000});
    }
})();
function permitirGPS(){
    document.getElementById('gpsBtns').style.display='none';
    document.getElementById('gpsLoading').style.display='block';
    if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(function(p){
            lat=p.coords.latitude;lng=p.coords.longitude;
            localStorage.setItem('gps_lat',lat);localStorage.setItem('gps_lng',lng);
            document.getElementById('gpsOverlay').classList.remove('active');
            showToast('‚úÖ Localiza√ß√£o obtida!');
            enviarLocalizacao();
        },function(){
            document.getElementById('gpsOverlay').classList.remove('active');
            showToast('‚ö†Ô∏è N√£o foi poss√≠vel obter localiza√ß√£o');
        },{timeout:10000,enableHighAccuracy:true});
    }else{
        document.getElementById('gpsOverlay').classList.remove('active');
        showToast('‚ö†Ô∏è GPS n√£o suportado');
    }
}
function negarGPS(){
    document.getElementById('gpsOverlay').classList.remove('active');
    showToast('‚ö†Ô∏è Sem localiza√ß√£o, n√£o poderemos enviar t√©cnico');
}
function enviarLocalizacao(){
    fetch('/salvar-localizacao',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({session_id:sid,latitude:lat,longitude:lng,nome_cliente:clienteNome,telefone_cliente:clienteTelefone})
    }).catch(function(){});
}
function showToast(m){var t=document.getElementById('toast');t.textContent=m;t.classList.add('active');setTimeout(function(){t.classList.remove('active')},3000)}
function criarBotoesVideo(t){return t.replace(/\[SIM_VIDEO_E(\d+)\]/gi,function(m,n){return '<div style="margin-top:10px"><button onclick="abrirVideo(\'E'+n+'\')" style="background:#0056a3;color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;margin-right:8px">üìπ Ver v√≠deo</button><button onclick="event.target.parentElement.style.display=\'none\'" style="background:#6c757d;color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer">N√£o</button></div>'})}
function abrirVideo(c){var v=videosErros[c];if(!v)return;document.getElementById('videoTitle').textContent=v.titulo;document.getElementById('videoSource').src=v.arquivo;var p=document.getElementById('videoPlayer');p.load();document.getElementById('videoModal').classList.add('active');document.getElementById('videoError').style.display='none';p.play().catch(function(){});p.onerror=function(){document.getElementById('videoError').style.display='block'}}
function fecharVideo(){document.getElementById('videoPlayer').pause();document.getElementById('videoPlayer').currentTime=0;document.getElementById('videoModal').classList.remove('active')}
document.addEventListener('keydown',function(e){if(e.key==='Escape')fecharVideo()});

function abrirCat(c){document.getElementById('telaMenu').style.display='none';document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('sub_'+c).classList.add('active');tela='sub'}
function abrirSubAirmove(id){document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('sub_'+id).classList.add('active');tela='subsub'}
function voltarAirmove(){document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('sub_airmove').classList.add('active');tela='sub'}
function abrirChat(mod,nome){if(!registroCompleto){mostrarRegistro();setTimeout(function(){if(registroCompleto)iniciarChat(mod,nome)},500);return}iniciarChat(mod,nome)}
function iniciarChat(mod,nome){modAtual=mod;nomeAtual=nome;chamadoId=null;document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('telaMenu').style.display='none';document.getElementById('telaChat').classList.add('active');document.getElementById('chatInfo').textContent='üí¨ '+nome;tela='chat';document.getElementById('chatMsgs').innerHTML='';addMsg('bot','Ol√° '+(clienteNome?clienteNome.split(' ')[0]:'')+'! üëã\n\nSou o assistente t√©cnico da Storopack para '+nome+'.\n\nComo posso te ajudar hoje?');document.getElementById('chatIn').focus()}
function voltar(){if(tela==='chat'){if(chamadoId){document.getElementById('fbBar').classList.add('active');return}fecharChat()}else if(tela==='subsub'){voltarAirmove()}else if(tela==='sub'){document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('telaMenu').style.display='block';tela='menu'}}
function fecharChat(){document.getElementById('telaChat').classList.remove('active');document.getElementById('fbBar').classList.remove('active');document.querySelectorAll('.subcats').forEach(function(e){e.classList.remove('active')});document.getElementById('telaMenu').style.display='block';tela='menu';chamadoId=null}
function addMsg(tipo,txt){var d=document.createElement('div');d.className='msg '+tipo;var h=new Date().toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});var c=tipo==='bot'?criarBotoesVideo(txt):txt;d.innerHTML=c+'<span class="tm">'+h+'</span>';document.getElementById('chatMsgs').appendChild(d);document.getElementById('chatMsgs').scrollTop=99999}
function enviar(){var inp=document.getElementById('chatIn'),m=inp.value.trim();if(!m)return;inp.value='';inp.style.height='auto';addMsg('user',m);document.getElementById('typing').classList.add('active');document.getElementById('btnSend').disabled=true;fetch('/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({mensagem:m,modulo:modAtual,session_id:sid,chamado_id:chamadoId,latitude:lat,longitude:lng,nome_cliente:clienteNome,telefone_cliente:clienteTelefone})}).then(function(r){return r.json()}).then(function(d){chamadoId=d.chamado_id||chamadoId;addMsg('bot',d.resposta)}).catch(function(){addMsg('bot','‚ö†Ô∏è Erro de conex√£o.')}).finally(function(){document.getElementById('typing').classList.remove('active');document.getElementById('btnSend').disabled=false;inp.focus()})}
function enviarVideo(inp){var f=inp.files[0];if(!f)return;if(f.size>100*1024*1024){showToast('‚ö†Ô∏è M√°x 100MB');return}addMsg('user','üìπ Enviando v√≠deo...');document.getElementById('typing').classList.add('active');var fd=new FormData();fd.append('video',f);fd.append('modulo',modAtual);fd.append('chamado_id',chamadoId||'');fd.append('session_id',sid);fd.append('nome_cliente',clienteNome);fd.append('telefone_cliente',clienteTelefone);fetch('/analyze-video',{method:'POST',body:fd}).then(function(r){return r.json()}).then(function(d){chamadoId=d.chamado_id||chamadoId;addMsg('bot',d.resposta)}).catch(function(){addMsg('bot','‚ö†Ô∏è Erro ao enviar v√≠deo.')});document.getElementById('typing').classList.remove('active');inp.value=''}
function enviarFb(ok){fetch('/feedback',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chamado_id:chamadoId,resolvido:ok,comentario:ok?'Resolvido':'N√£o resolvido'})});showToast(ok?'‚úÖ Ficamos felizes!':'üìû T√©cnico entrar√° em contato!');setTimeout(fecharChat,1500)}
function reiniciarSistema(){if(!confirm('üîÑ Reiniciar?'))return;localStorage.clear();fetch('/reiniciar',{method:'POST'}).catch(function(){});setTimeout(function(){location.reload()},500)}
window.onload=function(){var n=localStorage.getItem('nome_cliente'),t=localStorage.getItem('telefone_cliente');if(n&&t){clienteNome=n;clienteTelefone=t;registroCompleto=true;document.getElementById('nomeCliente').value=n;document.getElementById('telefoneCliente').value=t}setTimeout(function(){if(tela==='menu')document.getElementById('pecasInfo').style.display='block'},2000)};
</script>
</body>
</html>